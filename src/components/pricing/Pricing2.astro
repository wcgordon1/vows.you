---
export const description = "Pricing section with three tiers";

// Components
import Text from "@/components/fundations/elements/Text.astro";
import Button from "@/components/fundations/elements/Button.astro";
import Wrapper from "@/components/fundations/containers/Wrapper.astro";

// Icons (import all used ones)
import Check from "@/components/fundations/icons/Check.astro";

const pricingOptions = [
  {
    id: "Free",
    cardClass: "bg-sand-50 ",
    primaryTextColor: "text-base-900",
    secondaryTextColor: "text-base-500",
    featuresBorderColor: "border-base-200",
    title: "Free",
    monthly: "$0",
    annual: "$0",
    description:
      "Try vows.you and see if it feels right. No commitment.",
    button: {
      text: "Start writing",
      variant: "accent",
    },
    features: [
      { text: "Guided prompts" },
      { text: "Basic structure guide" },
      { text: "Save 1 draft" },
      { text: "Read time estimate" },
      { text: "Export to text" },
    ],
  },
  {
    id: "Complete",
    cardClass: "bg-sand-100",
    primaryTextColor: "text-base-900",
    secondaryTextColor: "text-base-500",
    featuresBorderColor: "border-base-200",
    title: "Complete",
    monthly: "$29.00",
    annual: "$19.00",
    description: "Everything you need to write vows you'll be proud of.",
    button: {
      text: "Start writing",
      variant: "accent",
    },
    features: [
      { text: "All prompts and guides" },
      { text: "Unlimited drafts" },
      { text: "Practice mode with timing" },
      { text: "Tone suggestions" },
      { text: "Print-ready export" },
      { text: "Email support" },
    ],
  },
  {
    id: "Couple",
    cardClass: "bg-sand-50 ",
    primaryTextColor: "text-base-900",
    secondaryTextColor: "text-base-500",
    featuresBorderColor: "border-base-200",
    title: "Couple",
    monthly: "$49.00",
    annual: "$39.00",
    description:
      "For both of you. Write separately, share when you're ready.",
    button: {
      text: "Start together",
      variant: "accent",
    },
    features: [
      { text: "Everything in Complete" },
      { text: "2 separate accounts" },
      { text: "Shared length tracking" },
      { text: "Priority support" },
      { text: "Ceremony day checklist" },
    ],
  },
  {
    id: "Gift",
    cardClass: "bg-sand-50 ",
    primaryTextColor: "text-base-900",
    secondaryTextColor: "text-base-500",
    featuresBorderColor: "border-base-200",
    title: "Gift",
    monthly: "$59.00",
    annual: "$49.00",
    description:
      "Give the gift of meaningful vows. Perfect for engaged couples.",
    button: {
      text: "Give a gift",
      variant: "default",
    },
    features: [
      { text: "Couple plan for two" },
      { text: "Gift message included" },
      { text: "Instant delivery" },
      { text: "No subscription needed" },
      { text: "Valid for 1 year" },
    ],
  },
];
---

<section
  id="pricing-section"
  class="border-t border-base-200 border-dashed scroll-mt-24"
>
  <Wrapper variant="standard" class="pt-12 pb-4">
    <div class="text-center text-balance">
      <Text
        tag="h2"
        variant="displayMD"
        class="font-serif font-medium tracking-tight text-black"
      >
        Simple, transparent pricing
      </Text>
      <Text
        tag="p"
        variant="textBase"
        class="max-w-xl mx-auto mt-4 text-base-500"
      >
        Start free. Upgrade when you want the full experience.
      </Text>

      <!-- Pricing Toggle -->
      <div
        aria-labelledby="pricing-toggle"
        class="relative z-0 inline-flex justify-center p-1 mx-auto mt-8 overflow-hidden bg-white shadow ring-1 ring-base-200 ring-offset-2 gap-4 lg:mx-0 rounded-md w-fit"
      >
        <div
          id="toggle-slider"
          class="absolute inset-0 w-1/2 bg-base-50 rounded-md transition-transform duration-200 ease-in-out"
        >
        </div>

        <button
          id="monthly-btn"
          class="relative z-10 flex items-center justify-center w-full h-6 px-2 text-xs font-medium focus:outline-none transition-colors duration-300 text-base-600"
          type="button"
          aria-pressed="true"
        >
          Monthly
        </button>

        <button
          id="annual-btn"
          class="relative z-10 flex items-center justify-center w-full h-6 px-2 text-xs font-medium focus:outline-none transition-colors duration-300 focus:text-base-900 hover:text-base-900"
          type="button"
          aria-pressed="false"
        >
          Annual
        </button>
      </div>
    </div>

    <!-- Pricing Cards -->
    <div class="mt-12 grid grid-cols-1 gap-4 md:grid-cols-2">
      {
        pricingOptions.map((tier) => (
          <div class={`flex flex-col p-4 rounded-xl ${tier.cardClass}`}>
            <div class="flex flex-col">
              <Text
                tag="h3"
                variant="textBase"
                class={` font-medium text-base-900 ${tier.primaryTextColor}`}
              >
                {tier.title}
              </Text>
              <Text
                variant="displayLG"
                class={`font-medium flex items-baseline tracking-tighter mt-4 font-serif ${tier.primaryTextColor}`}
              >
                <span
                  class="pricing-amount"
                  data-monthly={tier.monthly}
                  data-annual={tier.annual}
                >
                  {tier.monthly}
                </span>
                <span
                  class={`text-sm font-normal tracking-normal ${tier.secondaryTextColor}`}
                >
                  <span class="monthly-text">/month</span>
                  <span class="annual-text" style="display: none;">
                    /annually
                  </span>
                </span>
              </Text>

              <Text
                tag="p"
                variant="textLG"
                class={`mt-4 text-balance ${tier.secondaryTextColor}`}
              >
                {tier.description}
              </Text>
              <div class="w-full mt-8">
                <Button class="w-full" variant={tier.button.variant} size="sm">
                  {tier.button.text}
                </Button>
              </div>
            </div>
            <div class={`mt-4 pt-4 border-t ${tier.featuresBorderColor}  `}>
              <Text
                tag="p"
                variant="textXS"
                class={`font-medium uppercase ${tier.secondaryTextColor}`}
              >
                {tier.title === "Momentum"
                  ? "Everything in Core plus:"
                  : "Core plan includes:"}
              </Text>
              <ul
                class={`flex flex-col mt-4 text-sm  gap-y-3 ${tier.primaryTextColor}`}
                role="list"
              >
                {tier.features.map((feature, index) => (
                  <li class="flex items-start gap-2">
                    <Check
                      size="sm"
                      class={`shrink-0 ${tier.secondaryTextColor}`}
                    />
                    <span>{feature.text}</span>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        ))
      }
    </div>
  </Wrapper>

  <script type="module">
    // Initialize vanilla JS pricing toggle functionality
    document.addEventListener("DOMContentLoaded", function () {
      const monthlyBtn = document.getElementById("monthly-btn");
      const annualBtn = document.getElementById("annual-btn");
      const toggleSlider = document.getElementById("toggle-slider");
      const pricingAmounts = document.querySelectorAll(".pricing-amount");
      const monthlyTexts = document.querySelectorAll(".monthly-text");
      const annualTexts = document.querySelectorAll(".annual-text");

      // accent state is monthly
      let currentDuration = "monthly";

      // Function to update UI based on selected duration
      function updatePricingUI(duration) {
        // Update toggle slider position
        if (duration === "monthly") {
          toggleSlider.style.transform = "translateX(0)";
          monthlyBtn.classList.add("text-base-600");
          monthlyBtn.classList.remove(
            "focus:text-base-900",
            "hover:text-base-900"
          );
          annualBtn.classList.remove("text-base-600");
          annualBtn.classList.add("focus:text-base-900", "hover:text-base-900");
          monthlyBtn.setAttribute("aria-pressed", "true");
          annualBtn.setAttribute("aria-pressed", "false");
        } else {
          toggleSlider.style.transform = "translateX(100%)";
          annualBtn.classList.add("text-base-600");
          annualBtn.classList.remove(
            "focus:text-base-900",
            "hover:text-base-900"
          );
          monthlyBtn.classList.remove("text-base-600");
          monthlyBtn.classList.add(
            "focus:text-base-900",
            "hover:text-base-900"
          );
          monthlyBtn.setAttribute("aria-pressed", "false");
          annualBtn.setAttribute("aria-pressed", "true");
        }

        // Update pricing text
        pricingAmounts.forEach((amount) => {
          amount.textContent = amount.dataset[duration];
        });

        // Show/hide appropriate text
        if (duration === "monthly") {
          monthlyTexts.forEach((text) => (text.style.display = "inline"));
          annualTexts.forEach((text) => (text.style.display = "none"));
        } else {
          monthlyTexts.forEach((text) => (text.style.display = "none"));
          annualTexts.forEach((text) => (text.style.display = "inline"));
        }

        // Update current duration
        currentDuration = duration;
      }

      // Add event listeners to buttons
      monthlyBtn.addEventListener("click", function () {
        updatePricingUI("monthly");
      });

      annualBtn.addEventListener("click", function () {
        updatePricingUI("annual");
      });

      // Initialize UI
      updatePricingUI(currentDuration);
    });
  </script>
</section>
